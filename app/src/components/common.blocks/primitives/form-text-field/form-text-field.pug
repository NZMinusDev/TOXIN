include ~@common.blocks/primitives/heading/heading.pug

//- class - class for component bem mix: such as positioning functionality
//- data-is-filter: {boolean} - if true, input change event will reload page with chosen value(get method)
//- heading?: { tag: text }, example: { h3: 'awesome heading' }
//- type - type of field for validation: 'email' | 'password' | 'date' 
//- name - name of input field
//- value - init value of field
//- placeholder - placeholder text
//- autofocus - just add it for it works
//- data-material-icon - material icon name for submit btn in field
mixin form-text-field
  -
    const allowedInputmaskTypes = ['text', 'search', 'tel', 'url', 'password'];
    const allowedInputmodeAttribute = [
      'none',
      'text',
      'decimal',
      'numeric',
      'tel',
      'search',
      'email',
      'url',
    ];
    const reservedPlaceholders = { email: 'Email', password: 'Пароль', date: 'ДД.ММ.ГГГГ' };

    const componentClassModificator = attributes.type
      ? `form-text-field_is${attributes.type[0].toUpperCase()}${attributes.type.slice(1)}`
      : '';
    const inputMaskType = allowedInputmaskTypes.find((type) => type === attributes.type) || 'text';
    const inputModeAttr =
      allowedInputmodeAttribute.find((type) => type === attributes.type) || 'text';
  .form-text-field(class=[componentClassModificator, attributes.class])
    if attributes.heading
      +heading(attributes.heading, { isLabel: true })(for=attributes.name)
    .form-field
      input.form-text-field__input(
        data-is-filter=attributes['data-is-filter'] ? `${attributes['data-is-filter']}` : null,
        type=inputMaskType,
        inputmode=inputModeAttr,
        name=attributes.name,
        id=attributes.name,
        placeholder=reservedPlaceholders[attributes.type] || attributes.placeholder,
        value=attributes.value,
        autofocus=attributes.autofocus
      )
      if attributes['data-material-icon']
        button.icon.form-text-field__link-icon(
          type="submit",
          data-icon=attributes['data-material-icon']
        )
